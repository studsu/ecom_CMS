{% extends "admin/base_site.html" %}
{% load static %}

{% block title %}Update Settings{% endblock %}

{% block extrahead %}
<style>
    .settings-container {
        max-width: 800px;
        margin: 20px auto;
        padding: 20px;
    }

    .settings-header {
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        color: white;
        padding: 20px;
        border-radius: 8px;
        margin-bottom: 30px;
        text-align: center;
    }

    .form-section {
        background: white;
        border: 1px solid #ddd;
        border-radius: 8px;
        padding: 20px;
        margin-bottom: 20px;
    }

    .section-title {
        font-size: 1.2em;
        font-weight: bold;
        color: #667eea;
        border-bottom: 2px solid #667eea;
        padding-bottom: 10px;
        margin-bottom: 20px;
    }

    .form-group {
        margin-bottom: 20px;
    }

    .form-group label {
        display: block;
        font-weight: bold;
        margin-bottom: 5px;
        color: #333;
    }

    .form-group input,
    .form-group select,
    .form-group textarea {
        width: 100%;
        padding: 8px 12px;
        border: 1px solid #ddd;
        border-radius: 4px;
        font-size: 14px;
    }

    .form-group input[type="checkbox"] {
        width: auto;
        margin-right: 8px;
    }

    .help-text {
        font-size: 0.9em;
        color: #666;
        margin-top: 5px;
    }

    .btn {
        padding: 10px 20px;
        border: none;
        border-radius: 4px;
        cursor: pointer;
        font-size: 16px;
        text-decoration: none;
        display: inline-block;
        margin-right: 10px;
    }

    .btn-primary {
        background: #667eea;
        color: white;
    }

    .btn-secondary {
        background: #6c757d;
        color: white;
    }

    .checkbox-group {
        display: flex;
        align-items: center;
        margin-bottom: 10px;
    }

    .checkbox-group label {
        margin: 0;
        margin-left: 8px;
        font-weight: normal;
    }
</style>
{% endblock %}

{% block content %}
<div class="settings-container">
    <div class="settings-header">
        <h1>‚öôÔ∏è Update Settings</h1>
        <p>Configure automatic update checking and installation preferences</p>
    </div>

    <form method="post">
        {% csrf_token %}

        <!-- Automatic Updates Section -->
        <div class="form-section">
            <div class="section-title">üîÑ Automatic Updates</div>

            <div class="checkbox-group">
                <input type="checkbox" id="auto_check_enabled" name="auto_check_enabled"
                       {% if settings.auto_check_enabled %}checked{% endif %}>
                <label for="auto_check_enabled">Enable automatic update checking</label>
            </div>
            <div class="help-text">Automatically check for new CMS updates</div>

            <div class="form-group">
                <label for="check_frequency">Check Frequency</label>
                <select id="check_frequency" name="check_frequency">
                    {% for value, label in settings.CHECK_FREQUENCIES %}
                    <option value="{{ value }}" {% if settings.check_frequency == value %}selected{% endif %}>
                        {{ label }}
                    </option>
                    {% endfor %}
                </select>
                <div class="help-text">How often to check for updates</div>
            </div>

            <div class="checkbox-group">
                <input type="checkbox" id="auto_install_enabled" name="auto_install_enabled"
                       {% if settings.auto_install_enabled %}checked{% endif %}>
                <label for="auto_install_enabled">Auto-install non-critical updates</label>
            </div>
            <div class="help-text">Automatically install normal updates (not recommended for production)</div>

            <div class="checkbox-group">
                <input type="checkbox" id="install_critical_updates" name="install_critical_updates"
                       {% if settings.install_critical_updates %}checked{% endif %}>
                <label for="install_critical_updates">Auto-install critical security updates</label>
            </div>
            <div class="help-text">Automatically install critical security patches (recommended)</div>
        </div>

        <!-- Backup Settings Section -->
        <div class="form-section">
            <div class="section-title">üíæ Backup Settings</div>

            <div class="checkbox-group">
                <input type="checkbox" id="backup_before_update" name="backup_before_update"
                       {% if settings.backup_before_update %}checked{% endif %}>
                <label for="backup_before_update">Create backup before updates</label>
            </div>
            <div class="help-text">Always create a full backup before applying updates (strongly recommended)</div>

            <div class="form-group">
                <label for="max_backups_to_keep">Maximum backups to keep</label>
                <input type="number" id="max_backups_to_keep" name="max_backups_to_keep"
                       value="{{ settings.max_backups_to_keep }}" min="1" max="20">
                <div class="help-text">Number of backup files to retain (older backups will be deleted)</div>
            </div>
        </div>

        <!-- Update Server Section -->
        <div class="form-section">
            <div class="section-title">üåê Update Server</div>

            <div class="form-group">
                <label for="update_server_url">Update Server URL</label>
                <input type="url" id="update_server_url" name="update_server_url"
                       value="{{ settings.update_server_url }}" required>
                <div class="help-text">URL of the update server API</div>
            </div>

            <div class="form-group">
                <label for="api_key">API Key</label>
                <input type="text" id="api_key" name="api_key"
                       value="{{ settings.api_key }}" placeholder="Optional API key">
                <div class="help-text">API key for authenticated update server access (if required)</div>
            </div>

            <div class="checkbox-group">
                <input type="checkbox" id="beta_updates" name="beta_updates"
                       {% if settings.beta_updates %}checked{% endif %}>
                <label for="beta_updates">Include beta/pre-release updates</label>
            </div>
            <div class="help-text">Check for and offer beta versions (not recommended for production)</div>
        </div>

        <!-- Notifications Section -->
        <div class="form-section">
            <div class="section-title">üìß Notifications</div>

            <div class="form-group">
                <label for="notification_email">Notification Email</label>
                <input type="email" id="notification_email" name="notification_email"
                       value="{{ settings.notification_email }}" placeholder="admin@yoursite.com">
                <div class="help-text">Email address to notify about available updates</div>
            </div>
        </div>

        <!-- Action Buttons -->
        <div style="text-align: center; margin-top: 30px;">
            <button type="submit" class="btn btn-primary">üíæ Save Settings</button>
            <a href="{% url 'updates:dashboard' %}" class="btn btn-secondary">‚Üê Back to Dashboard</a>
        </div>
    </form>
</div>
{% endblock %}